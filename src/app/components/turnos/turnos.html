<div class="row" *ngIf="showTurnos">
    <plex-box>
        <div class="row">
            <div class="col-md-12">
                <label>Turnos: {{ag.horaInicio | date: 'dd/MM/yyyy'}}</label>
                <div class="list-group">
                    <div *ngFor="let bloque of ag.bloques; let i=index">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="col-md-7"><span><b>Bloque: </b>{{bloque.descripcion}}</span></div>
                                <div class="col-md-5" *ngIf="ag.estado == 'Suspendida'">
                                    <a class="hover" (click)="enviarSMS()"><i title="Enviar SMS" class="mdi mdi-message-draw"></i></a>
                                    <a class="hover" (click)="agregarPacienteListaEspera(ag)"><i title="Agregar Paciente a Lista Espera" class="mdi mdi-key"></i></a>
                                    <plex-bool name="seleccinar" [(ngModel)]="selectAll"></plex-bool>
                                    <!--<a class="hover" (click)="reasignarTurnosMasivo()"><i title="Reasignar Turno Masivo" class="mdi mdi-rotate-right"></i></a>-->
                                </div>
                                <table class="table table-hover">
                                    <tr *ngFor="let turno of bloque.turnos; let i=index" [ngClass]="{'text-success success': turno.paciente}">

                                        <td>
                                            <span>{{turno.horaInicio | date: 'HH:mm'}}</span>
                                        </td>

                                        <td>
                                            <span *ngIf="turno.botones.nombrePaciente">{{turno.paciente.apellido}} {{turno.paciente.nombre}}</span>
                                            <span *ngIf="turno.botones.lblTurnoDisponible">Disponible</span>
                                            <span *ngIf="turno.botones.lblTurnoNoDisponible">No Disponible</span>
                                        </td>

                                        <td *ngIf="turno.botones.asistencias">
                                            <a *ngIf="turno.botones.darAsistencia" id="darAsistencia" class="hover" (click)="eventosTurno(ag, turno, $event)"><i title="Dar Asistencia" class="text-success success mdi mdi-checkbox-multiple-blank-outline"></i></a>
                                            <a *ngIf="turno.botones.sacarAsistencia" id="sacarAsistencia" class="hover" (click)="eventosTurno(ag, turno, $event)"><i title="Sacar Asistencia" class="text-success success mdi mdi-checkbox-multiple-marked-outline"></i></a>
                                        </td>

                                        <td *ngIf="turno.botones.turnoDisponible">
                                            <i title="Turno Disponible" class="text-info info mdi mdi-select"></i>
                                        </td>

                                        <td *ngIf="turno.botones.tdSuspenderTurno">
                                            <a id="suspenderTurno" *ngIf="turno.botones.suspenderTurno" class="hover" mwlConfirmationPopover [title]="titleSuspenderTurno"
                                                [message]="messageSuspenderTurno" placement="top" (confirm)="suspenderTurno(ag, turno, confirmaSuspenderTurno = true)"
                                                (cancel)="cancelClicked = true" confirmText="Confirmar" cancelText="Cancelar">
                                                <i title="Suspender Turno" class="text-success success mdi mdi-power"></i>
                                            </a>

                                            <i *ngIf="turno.botones.suspenderTurnoDeshabilitado" title="No es posible suspender el Turno" class="text-info info mdi mdi-select"></i>
                                        </td>

                                        <td *ngIf="turno.botones.tdLiberarTurno">
                                            <a id="liberarTurno" *ngIf="turno.botones.liberarTurno" class="hover" mwlConfirmationPopover [title]="titleLiberarTurno"
                                                [message]="messageLiberarTurno" placement="top" (confirm)="liberarTurno(ag, turno, confirmaLiberarTurno = true)"
                                                (cancel)="cancelClicked = true" confirmText="Confirmar" cancelText="Cancelar">
                                                <i title="Liberar Turno" class="text-success success mdi mdi-stop"></i>
                                            </a>

                                            <i *ngIf="turno.botones.liberarTurnoDeshabilitado" title="No es posible Liberar el Turno" class="text-success success mdi mdi-select"></i>
                                        </td>

                                        <td *ngIf="turno.botones.tdBloquearTurno">
                                            <a id="bloquearTurno" class="hover" (click)="eventosTurno(ag, turno, $event)">
                                                <i *ngIf="turno.botones.bloquearTurno" title="Bloquear Turno" class="text-success success mdi mdi-brightness-1">
                                                </i>
                                                <i *ngIf="turno.botones.desbloquearTurno" title="Desbloquear Turno" class="text-success success mdi mdi-block-helper">
                                                </i>
                                            </a>

                                            <i *ngIf="turno.botones.bloquearTurnoDeshabilitado" title="No es posible bloquear el Turno" class="text-success success mdi mdi-select"></i>
                                        </td>

                                        <td *ngIf="true">
                                            <a class="hover">
                                                <i *ngIf="turno.botones.reasignarTurno" title="Reasignar Turno" (click)="reasignarTurno(turno.paciente, turno.id, ag.id)"
                                                    class="text-success success mdi mdi-backup-restore"></i>
                                            </a>

                                            <i *ngIf="turno.botones.reasignarTurnoDeshabilitado" title="No es posible reasignar Turno" class="text-success success mdi mdi-select"></i>
                                        </td>


                                        <td class="text-center" *ngIf="turno.botones.smsVisible">
                                            <!--<i *ngIf="turno.smsNoEnviadoVisible" title="SMS No Enviado" class="text-danger danger mdi mdi-checkbox-blank-circle-outline"></i>
                                            <i *ngIf="turno.smsEnviadoVisible" title="SMS Enviado" class="text-success success mdi mdi-checkbox-marked-circle-outline"></i>-->
                                            <i *ngIf="turno.botones.smsNoEnviado" title="SMS No Enviado" class="text-danger danger mdi mdi-checkbox-blank-circle-outline"></i>
                                            <i *ngIf="turno.botones.smsEnviado" title="SMS Enviado" class="text-success success mdi mdi-checkbox-marked-circle-outline"></i>
                                            <div>
                                                <plex-loader *ngIf="turno.botones.smsLoader" type="ball-pulse"></plex-loader>
                                            </div>
                                        </td>

                                        <td *ngIf="turno.botones.verNota">
                                            <a class="hover" (click)="agregarNotaTurno(ag, turno)"><i title="Agregar Nota" class="text-success success mdi mdi-message-text-outline"></i></a>
                                        </td>

                                        <!--<td *ngIf="turno.botones.verNota">
                                            <plex-text *ngIf="turno.botones.txtNota" [(ngModel)]="turno.nota" name="nota" placeholder="ingrese una Nota">
                                            </plex-text>
                                        </td>

                                        <td [hidden]="turno.btnGuardarNotaVisible">
                                            <a class="hover" (click)="guardarNota(ag, turno)"><i title="Agregar Nota" class="text-success success mdi mdi-content-save"></i></a>
                                        </td>-->

                                        <!--<td [hidden]="turno.chkVisible">
                                            <!--<plex-bool [ngModel]="turno.checked" (click)="agregarPaciente(turno)" ></plex-bool>-->
                                        <!--<plex-bool type="slide" [(ngModel)]="turno.checked" (click)="agregarPaciente(turno)"></plex-bool>
                                            <input type="checkbox" [ngModel]="turno.checked" [checked]=false (change)="agregarPaciente(turno)">
                                        </td>-->

                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </plex-box>
</div>

<div type="info" class="col-md-12" *ngIf="showLiberarTurno">
    <div class="clear"></div>
    <liberar-turno [agenda]="agenda" [turno]="turno" (saveLiberarTurno)="saveLiberarTurno($event)" (reasignarTurnoLiberado)="reasignarTurnoLiberado($event)"></liberar-turno>
</div>

<div type="info" class="col-md-12" *ngIf="showSuspenderTurno">
    <div class="clear"></div>
    <suspender-turno [agenda]="agenda" [turno]="turno" (saveSuspenderTurno)="saveSuspenderTurno($event)" (reasignarTurnoSuspendido)="reasignarTurnoSuspendido($event)"></suspender-turno>
</div>

<div type="info" class="col-md-12" *ngIf="showAgregarNotaTurno">
    <div class="clear"></div>
    <agregar-nota-turno [agenda]="agenda" [turno]="turno" (saveAgregarNotaTurno)="saveAgregarNotaTurno($event)"></agregar-nota-turno>
</div>
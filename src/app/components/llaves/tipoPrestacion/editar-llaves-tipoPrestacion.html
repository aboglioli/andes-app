<form *ngIf="showEditarLlave">
  <div class="row">
    <plex-box>
      <header>
        <div>
          <h5 *ngIf="!modelo.id">Nueva Llave</h5>
          <h5 *ngIf="modelo.id">Editar Llave</h5>
        </div>
      </header>
      <div class="row">
        <div class="col-12">
          <h5>Organizaci칩n: {{ modelo.organizacion?.nombre }}</h5>
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <plex-select [(ngModel)]="modelo.tipoPrestacion" name="tipoPrestacion" label="Tipo de Prestaci칩n" (getData)="loadTipoPrestaciones($event)"
            placeholder="Seleccione la Prestaci칩n" [required]="true" [readonly]="modelo.id"></plex-select>
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <plex-bool [(ngModel)]="modelo.auditable" name="auditable" label="Auditable"></plex-bool>
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <plex-bool [(ngModel)]="modelo.activa" name="activa" label="Activa"></plex-bool>
        </div>
      </div>
      <hr>
      <div class="row">
        <div class="col-12">
          <h5>Llaves</h5>
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <label>Rango edad:</label>
          <div class="row">
            <div class="col-2">
              <template [ngIf]="modelo.llave?.edad">
                <plex-int [(ngModel)]="modelo.llave.edad.desde.valor" name="desde" placeholder="desde" (change)="comprobarUnidades()"></plex-int>
              </template>
            </div>
            <div class="col-3">
              <template [ngIf]="modelo.llave?.edad && modelo.llave.edad?.desde.valor > 0">
                <plex-select [(ngModel)]="modelo.llave.edad.desde.unidad" name="unidadEdadDesde" (getData)="loadUnidadesEdad($event)" [required]="true"
                  (change)="comprobarUnidades()"></plex-select>
              </template>
            </div>
            <div class="col-1">
              <span class="btn">a</span>
            </div>
            <div class="col-2">
              <template [ngIf]="modelo.llave && (modelo.llave?.edad?.hasta || modelo.llave?.edad?.desde)">
                <plex-int [(ngModel)]="modelo.llave.edad.hasta.valor" name="hasta" placeholder="hasta" (change)="comprobarUnidades()"></plex-int>
              </template>
            </div>
            <div class="col-3">
              <template [ngIf]="modelo.llave?.edad && modelo.llave.edad?.hasta?.valor > 0">
                <plex-select [(ngModel)]="modelo.llave.edad.hasta.unidad" name="unidadEdadHasta" (getData)="loadUnidadesEdad($event)" [required]="true"
                  (change)="comprobarUnidades()"></plex-select>
              </template>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <template [ngIf]="modelo.llave">
            <plex-select [(ngModel)]="modelo.llave.sexo" name="sexo" label="Sexo" (getData)="loadSexo($event)" placeholder="Seleccione el sexo"></plex-select>
          </template>
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <template [ngIf]="modelo.llave && modelo.llave.solicitud">
            <plex-bool [(ngModel)]="modelo.llave.solicitud.requerida" name="solicitud" label="Requiere solicitud"></plex-bool><br><br>
            <div class="row" *ngIf="modelo.llave.solicitud.requerida && modelo.llave.solicitud.vencimiento">
                <div class="col-3"><span class="btn">Vencimiento:</span></div>
                <div class="col-2">
                    <plex-int [(ngModel)]="modelo.llave.solicitud.vencimiento.valor" name="vencimientoValor" placeholder="vencimiento"></plex-int>
                </div>
                <div class="col-3">
                    <template [ngIf]="modelo.llave?.solicitud.vencimiento && modelo.llave.solicitud.vencimiento?.valor > 0">
                        <plex-select [(ngModel)]="modelo.llave.solicitud.vencimiento.unidad" name="vencimientoUnidad" (getData)="loadUnidadesEdad($event)" [required]="true"></plex-select>
                    </template>
                </div>
                <div class="col" *ngIf="modelo.llave?.solicitud.vencimiento && modelo.llave.solicitud.vencimiento?.valor > 0">
                    a partir de la fecha de Solicitud
                </div>
            </div>
          </template>
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <plex-button icon="mdi mdi-content-save" label="Guardar" (click)="guardarLlaveTP($event)" title="Guardar" validateForm="true"></plex-button>
          <plex-button icon="mdi mdi-arrow-left" label="Cancelar" (click)="cancelar()" title="Cancelar"></plex-button>
        </div>
      </div>
    </plex-box>
  </div>
<footer>
  <div *ngIf="!unidadesValidas" class="alert alert-warning" role="alert">
    Rango de edades inv치lido
  </div>
</footer>
</form>

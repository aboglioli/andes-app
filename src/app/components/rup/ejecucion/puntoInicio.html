<header></header>

<section>
  <plex-box title="Pantalla inicio">
    <header>
      <div class="row">
        <div class="col">
          <h1>Lista de pacientes</h1>
        </div>
      </div>
    </header>

    <!-- Buscador de Pacientes MPI -->
    <div class="row" *ngIf="mostrarPacientesSearch">
      <div class="col">
        <pacientesSearch (change)="mostrarLista = false" (selected)="onPacienteSelected($event)" [modoCompleto]="false"></pacientesSearch>
      </div>
    </div>
    <div class="row" *ngIf="paciente">
      <div class="col">
        <header-paciente [paciente]="paciente"></header-paciente>
      </div>
    </div>
    <div class="row" *ngIf="paciente">
      <div class="col">
        <plex-select [(ngModel)]="prestacionSeleccion" name="nombrePrestacion" label="Tipos de prestaciones" (getData)="loadPrestacionesProfesional($event)"
          (change)="filtraPorPrestacion()">
        </plex-select>
      </div>
    </div>
    <div class="row" *ngIf="paciente && prestacionSeleccion">
      <div class="col">
        <plex-button icon="account" (click)="crearPrestacionVacia(prestacionSeleccion)" label="Generar PrestaciÃ³n" type="success"></plex-button>
      </div>
    </div>

    <!-- La Lista de Pacientes -->
    <div class="row" *ngIf="mostrarLista">
      <div class="col-3">
        <fieldset>
        </fieldset>
        <div class="row">
          <div class="col-6">
            <plex-datetime type="date" [(ngModel)]="fechaDesde" (change)="filtrarPorFecha()" name="horaInicio" label="Desde">
            </plex-datetime>
          </div>
          <div class="col-6">
            <plex-datetime type="date" [(ngModel)]="fechaHasta" (change)="filtrarPorFecha()" name="horaInicio" label="Hasta">
            </plex-datetime>
          </div>
        </div>
      </div>
      <div class="col-3">
        <label class="form-control-label">Filtrar por paciente</label>
        <!--Agregar las clases active ngclass-->
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-primary hover" [ngClass]="{active: filtrosPacientes == true}">
                  <input type="radio"name="options" id="inactivo"  (click)="soloPacientesProfesional()">
                   Solo mis pacientes
              </label>
          <label class="btn btn-primary hover" [ngClass]="{active: filtrosPacientes == false}">
                  <input type="radio"name="options" id="inactivo"  (click)="todosLosPacientes()">
                   Todos los pacientes
              </label>
        </div>
      </div>
      <div class="col-3">
        <fieldset>
          <!--<legend>Filtro por estado</legend>-->
        </fieldset>
        <plex-select [(ngModel)]="estadoSeleccion" name="nombrePrestacion" label="Estados" (getData)="loadEstados($event)" (change)="filtraPorEstado()">
        </plex-select>
      </div>
      <div class="col-3">
        <fieldset>
          <!--<legend>Filtro tipo de prestacion</legend>-->
        </fieldset>
        <plex-select [(ngModel)]="prestacionSeleccion" name="nombrePrestacion" label="Tipos de prestaciones" (getData)="loadPrestacionesProfesional($event)"
          (change)="filtraPorPrestacion()">
        </plex-select>
      </div>
    </div>
    <div class="row" *ngIf="mostrarLista">
      <div class="col 12">
        <table class="table table-hover table-bordered">
          <thead>
            <tr>
              <th><strong>Paciente</strong></th>
              <th><strong>Profesional</strong></th>
              <th><strong>Estado</strong></th>
              <th><strong>Tipo de prestacion</strong></th>
            </tr>
          </thead>
          <tbody>

            <tr class="item" *ngFor="let paciente of PacientesPresentes" (click)="elegirPrestacion(paciente.idPrestacion)">
              <th>
                {{paciente.paciente.nombre}} | {{paciente.paciente.apellido}}
              </th>
              <th>
                {{paciente.profesionales.nombre}} | {{paciente.profesionales.apellido}}
              </th>
              <th>
                {{paciente.estado}} ({{paciente.fecha | date: 'dd/MM/yyyy'}})
              </th>
              <th>
                {{paciente.nombrePrestacion}}
              </th>
            </tr>
          </tbody>
        </table>
      </div>

    </div>
  </plex-box>
</section>
<!--<pre>
  {{PacientesPresentes | json }}
</pre>-->

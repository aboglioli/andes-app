<div class="col-sm-12">
    <div class="panel panel-default">
        <div class="panel-heading">Actualizar de Pacientes</div>
        <div class="panel-body">
            <form [formGroup]="updateForm">
                <div class="row">
                    <div class="col-sm-4">
                        <div class="form-group">
                            <label>Nombre:</label>
                            <input type="text" class="form-control" formControlName="nombre" placeholder="Ingrese nombre...">
                            <label class="control-label text-danger" *ngIf="!updateForm.controls.nombre.valid">
                                (*)</label>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-group">
                            <label>Apellido:</label>
                            <input type="text" class="form-control" formControlName="apellido" placeholder="Ingrese apellido...">

                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-group">
                            <label>Alias:</label>
                            <input type="text" class="form-control" formControlName="alias" placeholder="Ingrese alias...">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-4">
                        <label> Documento: </label>
                        <input type="number" class="form-control" formControlName="documento" placeholder="Ingresar DNI...">
                    </div>
                    <div class="col-sm-4">
                        <label> Fecha de Nacimiento: </label>
                        <input type="date" class="form-control" formControlName="fechaNacimiento" placeholder="Ingresar Fecha de Nacimiento...">
                    </div>
                    <div class="col-sm-4">
                        <label> Estado: </label>
                        <select class="form-control" formControlName="estado">
                            <option value="">...</option>
                            <option *ngFor="let estado of estados" [ngValue]="estado" >{{estado}}</option>
                        </select>
                        <label class="control-label text-danger" *ngIf="!updateForm.controls.estado.valid">
                                (*)</label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-4">
                        <label> Sexo: </label>
                        <select class="form-control" formControlName="sexo">
                            <option value="">...</option>
                            <option *ngFor="let sexo of sexos" [ngValue]="sexo" >{{sexo}}</option>
                        </select>
                    </div>
                    <div class="col-sm-4">
                        <label> Genero: </label>
                        <select class="form-control" formControlName="genero">
                            <option value="">...</option>
                            <option *ngFor="let genero of generos" [ngValue]="genero" >{{genero}}</option>
                        </select>
                    </div>
                    <div class="col-sm-4">
                        <label> Estado Civil: </label>
                        <select class="form-control" formControlName="estadoCivil">
                            <option value="">...</option>
                            <option *ngFor="let estCivil of estadosCiviles" [ngValue]="estCivil" >{{estCivil}}</option>
                        </select>
                    </div>
                </div>
                <div class="row">&nbsp;</div>
                <div class="panel panel-default" formArrayName="contacto">
                    <div class="panel-heading"> Contactos </div>
                    <div class="panel-body">
                        <div class="list-group" *ngFor="let co of updateForm.controls.contacto.controls; let i=index">
                            <div class="row list-group-item" [formGroupName]="i">
                                <span class="badge" (click)="removeContacto(i)">x</span>
                                <div class="col-sm-4">
                                    <label> Tipo: </label>
                                    <select class="form-control" formControlName="tipo">
                                        <option value="">...</option>
                                        <option *ngFor="let tipo of tiposContactos" [ngValue]="tipo" >{{tipo}}</option>
                                    </select>
                                </div>
                                <div class="col-sm-4">
                                    <label> Dato: </label>
                                    <input type="text" class="form-control" formControlName="valor">
                                </div>
                                <div class="col-sm-2">
                                    <label> Orden: </label>
                                    <input type="number" class="form-control" formControlName="ranking">
                                </div>
                                <div class="form-group col-sm-2">
                                    <div class="checkbox">
                                        <label><input type="checkbox" formControlName="activo" checked="checked">Activo</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group col-sm-6">
                                <a (click)="addContacto()" style="cursor: default">Agregar Contacto +</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">&nbsp;</div>
                <div class="panel panel-default" formArrayName="direccion">
                    <div class="panel-heading"> Dirección </div>
                    <div class="panel-body" *ngFor="let dir of updateForm.controls.direccion.controls; let i=index">
                        <div [formGroupName]="i">
                            <div formGroupName="ubicacion">
                                <div class="row">
                                    <div class="col-sm-4">
                                        <label> País: </label>
                                        <select class="form-control" formControlName="pais" #pais (change)="filtrarProvincias(pais.selectedIndex,i)">
         
                                            <option *ngFor="let pais of paises" [ngValue]="pais">{{pais.nombre}}</option>
                                        </select>
                                    </div>
                                    <div class="col-sm-4">
                                        <label> Provincia: </label>
                                        <select class="form-control" formControlName="provincia" #provincia (change)="filtrarLocalidades(provincia.selectedIndex)"> 
                                      
                                            <option *ngFor="let provincia of provincias" [ngValue]="provincia">{{provincia.nombre}}</option>
                                        </select>
                                    </div>
                                    <div class="col-sm-4">
                                        <label> Localidad: </label>
                                        <select class="form-control" formControlName="localidad">
                                            <option *ngFor="let localidad of localidades" [ngValue]="localidad">{{localidad.nombre}}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-10">
                                    <label> Detalle de Domicilio: </label>
                                    <input type="text" class="form-control" formControlName="valor" placeholder="Ej: Belgrano 1547 - Piso 2 - Departamento 3....">
                                </div>
                                <div class="col-md-2">
                                    <label> CP: </label>
                                    <input type="text" class="form-control" formControlName="codigoPostal" placeholder="Ingrese CP...">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <label> Ultima Actualización: </label>
                                    <input type="date" class="form-control" formControlName="ultimaActualizacion" disable="disable">
                                </div>
                                <div class="col-md-2">
                                    <label> Orden: </label>
                                    <input type="text" class="form-control" formControlName="ranking">
                                </div>
                                <div class="form-group col-md-2"><br>
                                    <div class="checkbox">
                                        <label><input type="checkbox" formControlName="activo" checked="checked">Activo</label>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="row">
                            <div class="form-group col-sm-6">
                                <a (click)="addDireccion()" style="cursor: default">Agregar Dirección +</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">&nbsp;</div>
                <div class="panel panel-default" formArrayName="financiador">
                    <div class="panel-heading"> Financiador </div>
                    <div class="panel-body">
                        <div class="list-group" *ngFor="let fi of updateForm.controls.financiador.controls; let i=index">
                            <div class="row list-group-item" [formGroupName]="i">
                                <span class="badge" (click)="removeFinanciador(i)">x</span>
                                <div class="col-sm-4">
                                    <label> Obra Solcial: </label>
                                    <select class="form-control" formControlName="entidad">
                                        <option value="">...</option>
                                        <option *ngFor="let obraSocial of obrasSociales" [ngValue]="obraSocial" >{{obraSocial.nombre}}</option>
                                    </select>
                                </div>
                                <div class="col-sm-4">
                                    <label> Fecha Alta: </label>
                                    <input type="date" class="form-control" formControlName="fechaAlta">
                                </div>
                                <div class="col-sm-2">
                                    <label> Orden de prioridad: </label>
                                    <input type="number" class="form-control" formControlName="ranking">
                                </div>
                                <div class="form-group col-sm-2">
                                    <div class="checkbox">
                                        <label><input type="checkbox" formControlName="activo" checked="checked">Activo</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group col-sm-6">
                                <a (click)="addFinanciador()" style="cursor: default">Agregar Obra Social +</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">&nbsp;</div>
                <div class="panel panel-default">
                    <div class="panel-heading"> Relaciones </div>
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-sm-3">
                                <label> Relación: </label>
                                <select id="relRelacion" ngControl="relRelacion" class="form-control">
                                    <option value="">...</option>
                                    <option *ngFor="let rt of relacionTutores" [ngValue]="rt" >{{rt}}</option>
                                </select>
                                <span class="red" *ngIf="showCargar">*</span>
                            </div>
                            <div class="col-sm-4">
                                <label> Apellido: </label>
                                <input type="text" id="relApellido" class="form-control">
                                <span class="red" *ngIf="showCargar">*</span>
                            </div>
                            <div class="col-sm-4">
                                <label> Nombre: </label>
                                <input type="text" id="relNombre" class="form-control">
                                <span class="red" *ngIf="showCargar">*</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-3">
                                <label> Documento: </label>
                                <input type="number" id="relDocumento" class="form-control">
                                <span class="red" *ngIf="showCargar">*</span>
                            </div>
                            <div class="col-sm-3"><br>
                                <input type="button" class="btn btn-sm btn-primary" (click)="buscarPacRelacionado()" value="Buscar">
                                <input type="button" class="btn btn-sm btn-success" (click)="cargarDatos()" *ngIf="showCargar" value="Cargar">
                            </div>
                        </div>
                        <div class="row">&nbsp;</div>
                        <div class="row center">
                            <div class="col-sm-10">
                                <ul class="list-group">
                                    <li *ngFor="let paciente of pacRelacionados" class="list-group-item">
                                        ({{paciente.documento}}) - {{paciente.nombreCompleto}} / {{paciente.fechaNacimiento | date:"dd/MM/yyyy"}}
                                        <span class="badge success" (click)="validar(paciente)"> 
                                               <i class="glyphicon glyphicon-ok"></i> </span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="row">&nbsp;</div>
                        <div class="row">
                            <div class="form-group" [ngClass]="{'has-error':error}">
                                <div class="alert alert-danger" *ngIf="error"> {{mensaje}}</div>
                            </div>
                        </div>
                        <div class="row center">
                            <div class="col-sm-10" formArrayName="relaciones">
                                <ul class="list-group" *ngFor="let rel of updateForm.controls.relaciones.controls; let i=index">
                                    <li [formGroupName]="i" class="list-group-item">
                                        <div class="row">
                                            <div class="col-sm-3"><input type="text" class="form-control" formControlName="relacion"></div>
                                            <div class="col-sm-3"><input type="text" class="form-control" formControlName="documento"></div>
                                            <div class="col-sm-4"><input type="text" class="form-control" formControlName="apellido"></div>
                                            <div class="col-sm-1 rigth"><span class="badge" (click)="removeRelacion(i)"> x </span></div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="row">&nbsp;</div>

                <div class="row">
                    <div class="col-sm-4">
                        <button class="btn btn-primary" type="submit" (click)="onSave(updateForm.value, updateForm.valid)">Guardar</button>
                        <button class="btn btn-default" type="submit" (click)="onCancel()">Cancelar</button></div>
                </div>
            </form>
        </div>
    </div>
</div>